<!DOCTYPE html>
<html>
<head>
  <title>Dynamic Form Builder</title>
  <style>
    .error { color: red; font-size: 0.9em; }
  </style>
</head>
<body>
  <h2>Dynamic Form Builder</h2>
  <label>Select input type:
    <select id="inputType">
      <option value="text">Text</option>
      <option value="email">Email</option>
      <option value="password">Password</option>
    </select>
  </label>
  <button id="addInputBtn" type="button">Add</button>

  <form id="dynamicForm" novalidate>
    <button type="submit">Submit</button>
  </form>

  <script>
    const inputTypeSelect = document.getElementById('inputType');
    const addInputBtn = document.getElementById('addInputBtn');
    const dynamicForm = document.getElementById('dynamicForm');

    function getRegex(type) {
      switch(type) {
        case 'email': return /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        case 'password': return /^(?=.*[A-Z])(?=.*\d).{8,}$/;
        case 'text': return /^[A-Za-z\s]+$/;
        default: return /.*/;
      }
    }

    addInputBtn.addEventListener('click', () => {
      const type = inputTypeSelect.value;
      const div = document.createElement('div');
      const input = document.createElement('input');
      input.type = type;
      input.name = `input_${dynamicForm.elements.length}`;
      input.placeholder = `Enter ${type}`;
      const errorSpan = document.createElement('span');
      errorSpan.className = 'error';

      input.addEventListener('input', () => {
        const regex = getRegex(type);
        if (!regex.test(input.value.trim())) {
          errorSpan.textContent = `Invalid ${type} format`;
        } else {
          errorSpan.textContent = '';
        }
      });

      div.appendChild(input);
      div.appendChild(errorSpan);
      dynamicForm.insertBefore(div, dynamicForm.lastElementChild);
    });

    dynamicForm.addEventListener('submit', e => {
      const inputs = dynamicForm.querySelectorAll('input');
      let allValid = true;
      inputs.forEach(input => {
        const regex = getRegex(input.type);
        if (!regex.test(input.value.trim())) {
          allValid = false;
          input.nextElementSibling.textContent = `Invalid ${input.type} format`;
        }
      });
      if (!allValid) e.preventDefault();
    });
  </script>
</body>
</html>
